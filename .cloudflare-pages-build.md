# Cloudflare Pages 构建配置检查清单

## ⚠️ 重要：请确认以下设置

### 1. 构建设置（必须正确配置）

在 Cloudflare Pages Dashboard → **Settings** → **Builds & deployments** 中：

- ✅ **Framework preset**: `None`（不要选择其他预设）
- ✅ **Build command**: `npm run build`
- ✅ **Build output directory**: `dist`（必须与 vite.config.js 中的 outDir 一致）
- ✅ **Root directory**: `/`（项目根目录）
- ✅ **Node.js version**: `18` 或 `20`

### 2. 验证构建是否成功

构建完成后，检查构建日志：

1. ✅ 是否看到 `vite v5.x.x building for production...`
2. ✅ 是否看到 `built in xxx ms`
3. ✅ 是否生成 `dist` 目录

### 3. 检查构建输出

构建成功后，`dist/index.html` 应该：
- ✅ **不包含** `/src/main.jsx`
- ✅ **包含** `/assets/index-[hash].js` 或类似路径

如果 `dist/index.html` 仍包含 `/src/main.jsx`，说明构建没有正确执行。

### 4. 清除缓存

如果问题持续：
1. 在 Cloudflare Pages Dashboard 中清除构建缓存
2. 重新触发部署
3. 清除浏览器缓存（Ctrl+Shift+R 或 Cmd+Shift+R）

## 🔍 调试步骤

如果仍有问题，请检查：

1. **构建日志**：查看完整的构建输出，查找错误或警告
2. **网络请求**：在浏览器开发者工具中，查看 Network 标签，检查实际加载的文件路径
3. **控制台错误**：查看完整错误信息，确认是哪个文件导致的

## 📝 常见问题

### Q: 为什么浏览器仍加载 `/src/main.jsx`？
A: 这说明构建没有正确执行，或者构建输出目录配置错误。请确认：
- 构建命令是 `npm run build`
- 输出目录是 `dist`
- 构建日志显示成功

### Q: `_headers` 文件是否生效？
A: `_headers` 文件会被自动复制到 `dist` 目录。如果问题仍然存在，可能是：
- 文件路径不匹配
- Cloudflare Pages 缓存未清除
- 需要使用完整路径匹配

